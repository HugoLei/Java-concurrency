# Java 多线程内存模型
![](/assets/Java 内存模型.png)

## 线程私有内存（抽象概念）
每个线程都有一个私有的本地内存，用来存储该线程对主内存中共享变量的副本。
本地内存是JMM（Java Memory Model）的一个抽象概念，并不真实存在。它涵盖了缓存、写缓冲区、寄存器以及其他的硬件和编译器优。

Java内存模型规定所有的变量都是存在主存当中（类似于前面说的物理内存），每个线程都有自己的工作内存（类似于前面的高速缓存）。线程对变量的所有操作都必须在工作内存中进行，而不能直接对主存进行操作。并且每个线程不能访问其他线程的工作内存。

## 关于线程私有内存的一致性问题
这个模型非常类似于 CPU 高速缓存的模型，所以也会有一致性的问题出现，即多个线程的本地内存中共享变量副本的值不一致。

## 可见性
> JMM 通过控制线程本地内存与主内存之间的交互，来保证可见性。

例如线程 A 将共享变量的副本写回到主内存，然后线程 B 从主内存获取到新的共享变量。

